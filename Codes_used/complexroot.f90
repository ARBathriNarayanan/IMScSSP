!This program brings out the modified square root, where the branch cut is in the positive real axis, in contrast to the negative real axis of the normal square root.

PROGRAM COMPLEXROOT
   IMPLICIT NONE
   COMPLEX*16::X,XCON,Y,YCON,MSQRT
   X=(4,0.0001);XCON=(4,-0.0001);Y=(-4,0.0001);YCON=(-4,-0.0001)
   PRINT *,X,SQRT(X),MSQRT(X)
   PRINT *,XCON,SQRT(XCON),MSQRT(XCON)
   PRINT *,Y,SQRT(Y),MSQRT(Y)
   PRINT *,YCON,SQRT(YCON),MSQRT(YCON)
END PROGRAM

FUNCTION ZMOD(Z) RESULT(R)
   COMPLEX*16,intent(IN)::Z
   REAL*8::R
   R=(REAL(Z)*REAL(Z)+AIMAG(Z)*AIMAG(Z))
   R=SQRT(R)
END FUNCTION ZMOD

FUNCTION MSQRT(Z) RESULT(ZSQRT)
   COMPLEX*16,intent(IN)::Z
   COMPLEX*16::ZSQRT
   ZSQRT=SQRT(Z)
   IF (AIMAG(ZSQRT).LE.0) THEN
      ZSQRT=ZSQRT*(-1.D0)
   END IF
END FUNCTION MSQRT

!SAMPLE OUTPUT OF THIS PROGRAM
!(4.0000000000000000,9.99999974737875164E-005)         (2.0000000001562501,2.49999993664937532E-005)         (2.0000000001562501,2.49999993664937532E-005)
!(4.0000000000000000,-9.99999974737875164E-005)        (2.0000000001562501,-2.49999993664937532E-005)        (-2.0000000001562501,2.49999993664937532E-005)
!(-4.0000000000000000,9.99999974737875164E-005)         (2.49999993664937532E-005,2.0000000001562501)         (2.49999993664937532E-005,2.0000000001562501)
!(-4.0000000000000000,-9.99999974737875164E-005)        (2.49999993664937532E-005,-2.0000000001562501)        (-2.49999993664937532E-005,2.0000000001562501)

! The first column is the input, the second column is the normal square root and the third column is the modified square root
! As you can see, sqrt is discontinuous on -ve real axis and msqrt is discontinuous on +ve real axis
